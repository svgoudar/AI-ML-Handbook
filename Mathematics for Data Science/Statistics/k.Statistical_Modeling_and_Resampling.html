
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Statistical Modeling and Resampling &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Mathematics for Data Science/Statistics/k.Statistical_Modeling_and_Resampling';</script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../table_of_contents.html">Table of Contents</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/edit/master/docs/Mathematics for Data Science/Statistics/k.Statistical_Modeling_and_Resampling.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMathematics for Data Science/Statistics/k.Statistical_Modeling_and_Resampling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Mathematics for Data Science/Statistics/k.Statistical_Modeling_and_Resampling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistical Modeling and Resampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">📍 7. Statistical Modeling and Resampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-methods">Resampling Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">7.1. Bootstrapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-estimating-confidence-interval-for-median-income">Example Problem Statement: Estimating Confidence Interval for Median Income</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation">7.2. Cross-validation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-evaluating-a-simple-linear-regression-model">Example Problem Statement: Evaluating a Simple Linear Regression Model</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aic-akaike-information-criterion">7.1. AIC (Akaike Information Criterion)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bic-bayesian-information-criterion">7.2. BIC (Bayesian Information Criterion)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-comparing-regression-models-for-sales-prediction">Example Problem Statement: Comparing Regression Models for Sales Prediction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusted-r2">7.3. Adjusted R²</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-deciding-on-adding-predictors-to-a-sales-model">Example Problem Statement: Deciding on Adding Predictors to a Sales Model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="statistical-modeling-and-resampling">
<h1>Statistical Modeling and Resampling<a class="headerlink" href="#statistical-modeling-and-resampling" title="Link to this heading">#</a></h1>
<p>This notebook covers detailed explanations, manual calculations, plots, and example problem statements for key concepts in statistical modeling and resampling.</p>
<section id="id1">
<h2>📍 7. Statistical Modeling and Resampling<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<section id="resampling-methods">
<h3>Resampling Methods<a class="headerlink" href="#resampling-methods" title="Link to this heading">#</a></h3>
<p>Resampling methods are powerful techniques that involve repeatedly drawing samples from a dataset and fitting a model (or calculating a statistic) on these samples. They are primarily used for:</p>
<ol class="arabic simple">
<li><p><strong>Estimating the precision of sample statistics</strong> (e.g., standard errors, confidence intervals).</p></li>
<li><p><strong>Validating models</strong> by evaluating their performance on unseen data.</p></li>
</ol>
<section id="bootstrapping">
<h4>7.1. Bootstrapping<a class="headerlink" href="#bootstrapping" title="Link to this heading">#</a></h4>
<p><strong>Explanation:</strong>
Bootstrapping is a non-parametric resampling technique used to estimate the sampling distribution of a statistic by repeatedly re-sampling with replacement from the <em>observed</em> dataset. It’s particularly useful when the theoretical distribution of a statistic is unknown or difficult to derive, or when assumptions required for analytical methods (like normality) are not met.</p>
<p>The core idea is that the observed sample can be treated as a proxy for the entire population. By drawing many “bootstrap samples” from this observed sample (with replacement), we can simulate the process of drawing samples from the actual population.</p>
<p><strong>Steps for Bootstrapping:</strong></p>
<ol class="arabic simple">
<li><p><strong>Original Sample:</strong> Start with your original dataset of <span class="math notranslate nohighlight">\(N\)</span> observations.</p></li>
<li><p><strong>Bootstrap Samples:</strong> Create a large number (<span class="math notranslate nohighlight">\(B\)</span>, typically 1,000 to 10,000) of new samples, called “bootstrap samples.” Each bootstrap sample is created by randomly drawing <span class="math notranslate nohighlight">\(N\)</span> observations <em>with replacement</em> from your original sample. This means some observations might appear multiple times in a bootstrap sample, while others might not appear at all.</p></li>
<li><p><strong>Calculate Statistic:</strong> For each bootstrap sample, calculate the statistic of interest (e.g., mean, median, standard deviation, regression coefficient, correlation).</p></li>
<li><p><strong>Bootstrap Distribution:</strong> The collection of these <span class="math notranslate nohighlight">\(B\)</span> calculated statistics forms the “bootstrap distribution” of your statistic.</p></li>
<li><p><strong>Inference:</strong> Use this bootstrap distribution to estimate the standard error of the statistic, construct confidence intervals, or perform hypothesis tests.</p></li>
</ol>
<p><strong>Why use it?</strong></p>
<ul class="simple">
<li><p>Estimates standard errors and confidence intervals for complex statistics where analytical formulas are unavailable (e.g., median, quantiles, specific regression coefficients in complex models).</p></li>
<li><p>Does not require assumptions about the underlying population distribution (non-parametric).</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="example-problem-statement-estimating-confidence-interval-for-median-income">
<h4>Example Problem Statement: Estimating Confidence Interval for Median Income<a class="headerlink" href="#example-problem-statement-estimating-confidence-interval-for-median-income" title="Link to this heading">#</a></h4>
<p>A small startup has collected income data from its first 10 employees (in lakhs INR per annum):
<code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">60]</span></code></p>
<p>The founder wants to know the <strong>median income</strong> and a <strong>90% confidence interval</strong> for this median. The outlier (60 lakhs) makes the mean sensitive, and the small sample size might violate assumptions for standard parametric methods to estimate the median’s confidence interval. Bootstrapping is a good fit.</p>
<p><strong>Manual Calculation (Conceptual &amp; Simplified for 3 Bootstrap Samples):</strong></p>
<p>Original Data (N=10): <code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">60]</span></code>
True Median of Original Data: Sorting gives <code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">60]</span></code>. Median = <span class="math notranslate nohighlight">\((11+12)/2 = 11.5\)</span>.</p>
<p>Let’s manually perform 3 bootstrap samples (in reality, you’d do 1000s):</p>
<ul class="simple">
<li><p><strong>Bootstrap Sample 1:</strong> (drawing 10 values with replacement)
Suppose we draw: <code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">7,</span> <span class="pre">60,</span> <span class="pre">12,</span> <span class="pre">10,</span> <span class="pre">15,</span> <span class="pre">7,</span> <span class="pre">14,</span> <span class="pre">11,</span> <span class="pre">13]</span></code>
Sorted: <code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">7,</span> <span class="pre">10,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">60]</span></code>
Median of Sample 1: <span class="math notranslate nohighlight">\((11+12)/2 = \mathbf{11.5}\)</span></p></li>
<li><p><strong>Bootstrap Sample 2:</strong>
Suppose we draw: <code class="docutils literal notranslate"><span class="pre">[8,</span> <span class="pre">15,</span> <span class="pre">9,</span> <span class="pre">14,</span> <span class="pre">12,</span> <span class="pre">12,</span> <span class="pre">10,</span> <span class="pre">60,</span> <span class="pre">8,</span> <span class="pre">11]</span></code>
Sorted: <code class="docutils literal notranslate"><span class="pre">[8,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">12,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">60]</span></code>
Median of Sample 2: <span class="math notranslate nohighlight">\((11+12)/2 = \mathbf{11.5}\)</span></p></li>
<li><p><strong>Bootstrap Sample 3:</strong>
Suppose we draw: <code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15]</span></code> (note: 60 was not drawn in this sample)
Sorted: <code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10,</span> <span class="pre">11,</span> <span class="pre">12,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15]</span></code>
Median of Sample 3: <span class="math notranslate nohighlight">\((10+11)/2 = \mathbf{10.5}\)</span></p></li>
</ul>
<p>After many (e.g., 1000) such samples, you would have 1000 median values. To find the 90% confidence interval, you’d sort these 1000 medians and find the values at the 5th percentile and 95th percentile.</p>
<p><strong>Python Code for Bootstrapping &amp; Plot:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Set style for plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DejaVu Sans&#39;</span><span class="p">]</span> <span class="c1"># Default font</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Bootstrapping Example: Median Income Confidence Interval ---&quot;</span><span class="p">)</span>

<span class="c1"># Original Data</span>
<span class="n">original_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">original_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">original_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Data: </span><span class="si">{</span><span class="n">original_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median of Original Data: </span><span class="si">{</span><span class="n">original_median</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Number of bootstrap samples</span>
<span class="n">num_bootstraps</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="c1"># Store bootstrap medians</span>
<span class="n">bootstrap_medians</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Perform bootstrapping</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># for reproducibility</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_bootstraps</span><span class="p">):</span>
    <span class="c1"># Draw N samples with replacement from the original data</span>
    <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">original_data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Calculate the median of the bootstrap sample</span>
    <span class="n">bootstrap_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="p">)</span>
    <span class="n">bootstrap_medians</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bootstrap_median</span><span class="p">)</span>

<span class="n">bootstrap_medians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">)</span>

<span class="c1"># Calculate 90% Confidence Interval</span>
<span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bootstrap Statistics (from </span><span class="si">{</span><span class="n">num_bootstraps</span><span class="si">}</span><span class="s2"> samples):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of Bootstrap Medians: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard Error of Median (Bootstrap): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;90% Confidence Interval for Median: (</span><span class="si">{</span><span class="n">lower_bound</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_bound</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Plotting the Bootstrap Distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">bootstrap_medians</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">original_median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Original Median: </span><span class="si">{</span><span class="n">original_median</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;90% CI Lower Bound: </span><span class="si">{</span><span class="n">lower_bound</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;90% CI Upper Bound: </span><span class="si">{</span><span class="n">upper_bound</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bootstrap Distribution of Medians&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Median Income (Lakhs INR)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Bootstrapping Example: Median Income Confidence Interval ---
Original Data: [ 7  8  9 10 11 12 13 14 15 60]
Median of Original Data: 11.50

Bootstrap Statistics (from 5000 samples):
Mean of Bootstrap Medians: 11.58
Standard Error of Median (Bootstrap): 1.90
90% Confidence Interval for Median: (9.00, 14.00)
</pre></div>
</div>
<img alt="../../_images/cf696d423c52739e879583d0659169908ba6b6d68ac323ad93ba6d577a24dc21.png" src="../../_images/cf696d423c52739e879583d0659169908ba6b6d68ac323ad93ba6d577a24dc21.png" />
</div>
</div>
<p><strong>Interpretation of Bootstrapping Plot:</strong>
The histogram shows the distribution of the median values obtained from thousands of bootstrap samples. This distribution approximates the true sampling distribution of the median. The red dashed line marks the median of the original dataset. The green dotted lines mark the 5th and 95th percentiles of the bootstrap distribution, forming the 90% confidence interval. This visual allows us to understand the variability and uncertainty around our median estimate.</p>
</section>
<hr class="docutils" />
<section id="cross-validation">
<h4>7.2. Cross-validation<a class="headerlink" href="#cross-validation" title="Link to this heading">#</a></h4>
<p><strong>Explanation:</strong>
Cross-validation is a technique used to assess how well a statistical model will generalize to an independent dataset. It’s crucial for evaluating model performance and preventing overfitting, especially when you have limited data. The fundamental idea is to split the dataset into multiple subsets, train the model on some subsets, and evaluate it on the remaining (unseen) subset.</p>
<p><strong>Common Types of Cross-validation:</strong></p>
<ol class="arabic simple">
<li><p><strong>K-Fold Cross-validation:</strong></p>
<ul class="simple">
<li><p>The data is randomly divided into <span class="math notranslate nohighlight">\(K\)</span> equally sized folds (subsets).</p></li>
<li><p>The model is trained <span class="math notranslate nohighlight">\(K\)</span> times. In each iteration:</p>
<ul>
<li><p>One fold is used as the <strong>test set</strong>.</p></li>
<li><p>The remaining <span class="math notranslate nohighlight">\(K-1\)</span> folds are combined to form the <strong>training set</strong>.</p></li>
</ul>
</li>
<li><p>The performance metric (e.g., accuracy, MSE) is recorded for each of the <span class="math notranslate nohighlight">\(K\)</span> iterations.</p></li>
<li><p>The final performance is the average of the <span class="math notranslate nohighlight">\(K\)</span> recorded metrics.</p></li>
<li><p><strong>Pros:</strong> Good balance between bias and variance, uses all data for training and testing.</p></li>
<li><p><strong>Cons:</strong> Can be computationally intensive for large <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Leave-One-Out Cross-validation (LOOCV):</strong></p>
<ul class="simple">
<li><p>A special case of K-Fold where <span class="math notranslate nohighlight">\(K=N\)</span> (the number of observations).</p></li>
<li><p>In each iteration, one observation is used as the test set, and the remaining <span class="math notranslate nohighlight">\(N-1\)</span> observations are used for training.</p></li>
<li><p><strong>Pros:</strong> Maximizes the amount of data used for training in each fold, results in a low bias estimate.</p></li>
<li><p><strong>Cons:</strong> Very computationally expensive for large datasets; high variance in the performance estimates.</p></li>
</ul>
</li>
<li><p><strong>Stratified K-Fold Cross-validation:</strong></p>
<ul class="simple">
<li><p>Used primarily for classification problems when dealing with imbalanced datasets.</p></li>
<li><p>Ensures that each fold maintains the same proportion of target class labels as the original dataset. This prevents a fold from having too few (or zero) instances of a minority class.</p></li>
</ul>
</li>
</ol>
<p><strong>Why use it?</strong></p>
<ul class="simple">
<li><p>Provides a more robust and realistic estimate of a model’s performance on unseen data compared to a single train-test split.</p></li>
<li><p>Helps detect and mitigate overfitting (when a model performs well on training data but poorly on new data).</p></li>
<li><p>Useful for hyperparameter tuning.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="example-problem-statement-evaluating-a-simple-linear-regression-model">
<h4>Example Problem Statement: Evaluating a Simple Linear Regression Model<a class="headerlink" href="#example-problem-statement-evaluating-a-simple-linear-regression-model" title="Link to this heading">#</a></h4>
<p>A small online store wants to predict daily sales (in thousands INR) based on daily advertising spend (in hundreds INR). They have 6 days of data:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Ad Spend (X)</p></th>
<th class="head text-left"><p>Sales (Y)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2</p></td>
<td class="text-left"><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3</p></td>
<td class="text-left"><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>4</p></td>
<td class="text-left"><p>4.5</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5</p></td>
<td class="text-left"><p>5.5</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>6</p></td>
<td class="text-left"><p>6</p></td>
</tr>
</tbody>
</table>
</div>
<p>They want to evaluate a simple linear regression model using <strong>3-Fold Cross-validation</strong> to estimate its average performance (using Mean Squared Error - MSE).</p>
<p><strong>Manual Calculation (for 3-Fold Cross-validation):</strong></p>
<p>Original Data (N=6):
<span class="math notranslate nohighlight">\(X = [1, 2, 3, 4, 5, 6]\)</span>
<span class="math notranslate nohighlight">\(Y = [2, 3, 4, 4.5, 5.5, 6]\)</span></p>
<p>Let’s divide the data into 3 folds:</p>
<ul class="simple">
<li><p><strong>Fold 1:</strong> (1, 2), (2, 3)</p></li>
<li><p><strong>Fold 2:</strong> (3, 4), (4, 4.5)</p></li>
<li><p><strong>Fold 3:</strong> (5, 5.5), (6, 6)</p></li>
</ul>
<p><strong>Iteration 1:</strong></p>
<ul class="simple">
<li><p><strong>Test Set:</strong> Fold 1 <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">3)]</span></code></p></li>
<li><p><strong>Training Set:</strong> Fold 2 + Fold 3 <code class="docutils literal notranslate"><span class="pre">[(3,</span> <span class="pre">4),</span> <span class="pre">(4,</span> <span class="pre">4.5),</span> <span class="pre">(5,</span> <span class="pre">5.5),</span> <span class="pre">(6,</span> <span class="pre">6)]</span></code></p></li>
<li><p><strong>Train Model:</strong> Fit <span class="math notranslate nohighlight">\(Y = \\beta\_0 + \\beta\_1 X\)</span> on Training Set.
(Using Python/calculator, for this training set: <span class="math notranslate nohighlight">\(\\beta\_0 \\approx 1.5\)</span>, <span class="math notranslate nohighlight">\(\\beta\_1 \\approx 0.75\)</span>)
So, <span class="math notranslate nohighlight">\(Y\_{pred} = 1.5 + 0.75X\)</span></p></li>
<li><p><strong>Evaluate on Test Set:</strong></p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\((1, 2)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.5 + 0.75(1) = 2.25\)</span>. Squared Error = <span class="math notranslate nohighlight">\((2 - 2.25)^2 = 0.0625\)</span></p></li>
<li><p>For <span class="math notranslate nohighlight">\((2, 3)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.5 + 0.75(2) = 3.00\)</span>. Squared Error = <span class="math notranslate nohighlight">\((3 - 3.00)^2 = 0.0000\)</span></p></li>
<li><p>MSE for Iteration 1 = <span class="math notranslate nohighlight">\((0.0625 + 0.0000) / 2 = \\mathbf{0.03125}\)</span></p></li>
</ul>
</li>
</ul>
<p><strong>Iteration 2:</strong></p>
<ul class="simple">
<li><p><strong>Test Set:</strong> Fold 2 <code class="docutils literal notranslate"><span class="pre">[(3,</span> <span class="pre">4),</span> <span class="pre">(4,</span> <span class="pre">4.5)]</span></code></p></li>
<li><p><strong>Training Set:</strong> Fold 1 + Fold 3 <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">3),</span> <span class="pre">(5,</span> <span class="pre">5.5),</span> <span class="pre">(6,</span> <span class="pre">6)]</span></code></p></li>
<li><p><strong>Train Model:</strong> Fit <span class="math notranslate nohighlight">\(Y = \\beta\_0 + \\beta\_1 X\)</span> on Training Set.
(For this training set: <span class="math notranslate nohighlight">\(\\beta\_0 \\approx 1.2\)</span>, <span class="math notranslate nohighlight">\(\\beta\_1 \\approx 0.8\)</span>)
So, <span class="math notranslate nohighlight">\(Y\_{pred} = 1.2 + 0.8X\)</span></p></li>
<li><p><strong>Evaluate on Test Set:</strong></p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\((3, 4)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.2 + 0.8(3) = 3.6\)</span>. Squared Error = <span class="math notranslate nohighlight">\((4 - 3.6)^2 = 0.16\)</span></p></li>
<li><p>For <span class="math notranslate nohighlight">\((4, 4.5)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.2 + 0.8(4) = 4.4\)</span>. Squared Error = <span class="math notranslate nohighlight">\((4.5 - 4.4)^2 = 0.01\)</span></p></li>
<li><p>MSE for Iteration 2 = <span class="math notranslate nohighlight">\((0.16 + 0.01) / 2 = \\mathbf{0.085}\)</span></p></li>
</ul>
</li>
</ul>
<p><strong>Iteration 3:</strong></p>
<ul class="simple">
<li><p><strong>Test Set:</strong> Fold 3 <code class="docutils literal notranslate"><span class="pre">[(5,</span> <span class="pre">5.5),</span> <span class="pre">(6,</span> <span class="pre">6)]</span></code></p></li>
<li><p><strong>Training Set:</strong> Fold 1 + Fold 2 <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">3),</span> <span class="pre">(3,</span> <span class="pre">4),</span> <span class="pre">(4,</span> <span class="pre">4.5)]</span></code></p></li>
<li><p><strong>Train Model:</strong> Fit <span class="math notranslate nohighlight">\(Y = \\beta\_0 + \\beta\_1 X\)</span> on Training Set.
(For this training set: <span class="math notranslate nohighlight">\(\\beta\_0 \\approx 1.0\)</span>, <span class="math notranslate nohighlight">\(\\beta\_1 \\approx 0.8\)</span>)
So, <span class="math notranslate nohighlight">\(Y\_{pred} = 1.0 + 0.8X\)</span></p></li>
<li><p><strong>Evaluate on Test Set:</strong></p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\((5, 5.5)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.0 + 0.8(5) = 5.0\)</span>. Squared Error = <span class="math notranslate nohighlight">\((5.5 - 5.0)^2 = 0.25\)</span></p></li>
<li><p>For <span class="math notranslate nohighlight">\((6, 6)\)</span>: <span class="math notranslate nohighlight">\(Y\_{pred} = 1.0 + 0.8(6) = 5.8\)</span>. Squared Error = <span class="math notranslate nohighlight">\((6 - 5.8)^2 = 0.04\)</span></p></li>
<li><p>MSE for Iteration 3 = <span class="math notranslate nohighlight">\((0.25 + 0.04) / 2 = \\mathbf{0.145}\)</span></p></li>
</ul>
</li>
</ul>
<p><strong>Average MSE (Estimated Generalization Error):</strong>
Average MSE = <span class="math notranslate nohighlight">\((0.03125 + 0.085 + 0.145) / 3 = \\mathbf{0.087}\)</span></p>
<p><strong>Python Code for Cross-validation &amp; Plot:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="c1"># Set style for plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DejaVu Sans&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- K-Fold Cross-Validation Example ---&quot;</span><span class="p">)</span>

<span class="c1"># Original Data</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Ad Spend</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="c1"># Sales</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original X: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original y: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Initialize K-Fold Cross-Validation</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># 3 folds, shuffle for randomness</span>

<span class="n">mse_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fold_info</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Perform K-Fold Cross-Validation</span>
<span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
    <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

    <span class="c1"># Fit the model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Make predictions on the test set</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Calculate Mean Squared Error</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mse_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

    <span class="n">fold_info</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;train_indices&#39;</span><span class="p">:</span> <span class="n">train_index</span><span class="p">,</span>
        <span class="s1">&#39;test_indices&#39;</span><span class="p">:</span> <span class="n">test_index</span><span class="p">,</span>
        <span class="s1">&#39;test_mse&#39;</span><span class="p">:</span> <span class="n">mse</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold </span><span class="si">{</span><span class="n">fold</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Train Indices: </span><span class="si">{</span><span class="n">train_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Test Indices: </span><span class="si">{</span><span class="n">test_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Test MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">average_mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mse_scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average MSE across all folds: </span><span class="si">{</span><span class="n">average_mse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Plotting Cross-Validation Performance ---</span>
<span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fold_info</span><span class="p">]</span>
<span class="n">mses</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;test_mse&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fold_info</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">mses</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">average_mse</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Average MSE: </span><span class="si">{</span><span class="n">average_mse</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error for Each Cross-Validation Fold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fold Number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error (MSE)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">mses</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span> <span class="c1"># Adjust y-axis limit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Conceptual Plot of K-Fold Splits (manual illustration)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fold_size</span> <span class="o">=</span> <span class="n">num_data_points</span> <span class="o">//</span> <span class="n">num_folds</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_folds</span><span class="p">):</span>
    <span class="n">test_start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">fold_size</span>
    <span class="n">test_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fold_size</span>
    
    <span class="c1"># Represent data points</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">num_data_points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># Highlight test fold</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">test_start</span><span class="p">,</span> <span class="n">test_end</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">num_data_points</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: Test Set&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">num_data_points</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;Train Sets&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DP</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_data_points</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;K-Fold Cross-Validation: Iteration </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- K-Fold Cross-Validation Example ---
Original X: [1 2 3 4 5 6]
Original y: [2.  3.  4.  4.5 5.5 6. ]

Fold 1:
  Train Indices: [2 3 4 5]
  Test Indices: [0 1]
  Test MSE: 0.1825

Fold 2:
  Train Indices: [0 1 3 4]
  Test Indices: [2 5]
  Test MSE: 0.0763

Fold 3:
  Train Indices: [0 1 2 5]
  Test Indices: [3 4]
  Test MSE: 0.0166

Average MSE across all folds: 0.0918
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\sangouda\AppData\Local\Temp\ipykernel_51524\1559326093.py:64: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(x=folds, y=mses, palette=&#39;viridis&#39;, edgecolor=&#39;black&#39;)
</pre></div>
</div>
<img alt="../../_images/c8417e35e49a17d1d35e90b0ce37f2aa49f2f73c740e26018aa6d9e7882581c3.png" src="../../_images/c8417e35e49a17d1d35e90b0ce37f2aa49f2f73c740e26018aa6d9e7882581c3.png" />
<img alt="../../_images/17be4644b4e306adf9a2514b6061da0df2a196b86a8dc7c377f6721669a13222.png" src="../../_images/17be4644b4e306adf9a2514b6061da0df2a196b86a8dc7c377f6721669a13222.png" />
<img alt="../../_images/f5626fd64f62d2569684099ba7188d9e854365104252c3ed55e1ea10d1c792d2.png" src="../../_images/f5626fd64f62d2569684099ba7188d9e854365104252c3ed55e1ea10d1c792d2.png" />
<img alt="../../_images/2333705bdf84b0106d2a56db9643adb4af3a11786c0e36bf6f3f08e66dff13d4.png" src="../../_images/2333705bdf84b0106d2a56db9643adb4af3a11786c0e36bf6f3f08e66dff13d4.png" />
</div>
</div>
<p><strong>Interpretation of Cross-validation Plots:</strong></p>
<ul class="simple">
<li><p><strong>Bar Plot of MSEs:</strong> This plot shows the Mean Squared Error for each fold during cross-validation. It helps visualize the variability of model performance across different splits of the data. The red dashed line indicates the average MSE, which is the most robust estimate of the model’s generalization performance.</p></li>
<li><p><strong>Conceptual K-Fold Splits:</strong> These diagrams visually represent how the data is partitioned into training and testing sets in each iteration of K-Fold cross-validation. This makes it clear how all data points eventually serve as both training and test data, ensuring a comprehensive evaluation.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="model-selection">
<h3>Model Selection<a class="headerlink" href="#model-selection" title="Link to this heading">#</a></h3>
<p>Model selection is the process of choosing the best model from a set of candidate models. This often involves balancing model complexity with its ability to fit the data. Adding more parameters to a model <em>always</em> improves its fit to the training data (R² will always increase), but it can lead to overfitting. Model selection criteria help penalize complexity.</p>
<section id="aic-akaike-information-criterion">
<h4>7.1. AIC (Akaike Information Criterion)<a class="headerlink" href="#aic-akaike-information-criterion" title="Link to this heading">#</a></h4>
<p><strong>Explanation:</strong>
AIC is an estimator of the relative quality of statistical models for a given set of data. It attempts to balance the goodness of fit of the model with the complexity of the model. A lower AIC value generally indicates a better model.</p>
<p>The idea is to find the model that minimizes the information lost when approximating the true data-generating process. It penalizes models with more parameters (complexity).</p>
<p><strong>Formula:</strong>
For models estimated by maximum likelihood (e.g., OLS regression):
$<span class="math notranslate nohighlight">\(\text{AIC} = 2k - 2 \ln(L)\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of parameters in the model (including the intercept and the error variance).</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> is the maximum value of the likelihood function for the model.</p></li>
</ul>
<p>For linear regression models, using the Mean Squared Error (MSE) and Number of Observations (n):
$<span class="math notranslate nohighlight">\(\text{AIC} = n \cdot \ln\left(\frac{\text{SSE}}{n}\right) + 2k\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of observations.</p></li>
<li><p><span class="math notranslate nohighlight">\(\\text{SSE}\)</span> is the sum of squared errors (residuals).</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of parameters (number of predictors + 1 for intercept).</p></li>
</ul>
<p><strong>Interpretation:</strong>
When comparing multiple models, the model with the lowest AIC is preferred. However, AIC does not provide a test of a model in an absolute sense (i.e., it doesn’t tell you if a model is “good” or “bad”); rather, it’s a tool for comparing relative quality among candidate models.</p>
</section>
<hr class="docutils" />
<section id="bic-bayesian-information-criterion">
<h4>7.2. BIC (Bayesian Information Criterion)<a class="headerlink" href="#bic-bayesian-information-criterion" title="Link to this heading">#</a></h4>
<p><strong>Explanation:</strong>
BIC is another criterion for model selection among a finite set of models. Like AIC, it balances model fit with complexity, but it imposes a stronger penalty for the number of parameters, especially with larger datasets. This means BIC tends to favor simpler models than AIC, especially when the number of observations (<span class="math notranslate nohighlight">\(n\)</span>) is large.</p>
<p><strong>Formula:</strong>
$<span class="math notranslate nohighlight">\(\text{BIC} = k \ln(n) - 2 \ln(L)\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of parameters in the model.</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of observations.</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> is the maximum value of the likelihood function for the model.</p></li>
</ul>
<p>For linear regression models:
$<span class="math notranslate nohighlight">\(\text{BIC} = n \cdot \ln\left(\frac{\text{SSE}}{n}\right) + k \cdot \ln(n)\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of observations.</p></li>
<li><p><span class="math notranslate nohighlight">\(\\text{SSE}\)</span> is the sum of squared errors (residuals).</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of parameters (number of predictors + 1 for intercept).</p></li>
</ul>
<p><strong>Interpretation:</strong>
Similar to AIC, the model with the lowest BIC is preferred. BIC’s stronger penalty for complexity means it’s often more conservative and selects simpler models than AIC, which can be advantageous in preventing overfitting, especially with larger datasets where statistical significance might be easily achieved even with trivial improvements in fit.</p>
</section>
<hr class="docutils" />
<section id="example-problem-statement-comparing-regression-models-for-sales-prediction">
<h4>Example Problem Statement: Comparing Regression Models for Sales Prediction<a class="headerlink" href="#example-problem-statement-comparing-regression-models-for-sales-prediction" title="Link to this heading">#</a></h4>
<p>A retail company wants to predict weekly sales (<span class="math notranslate nohighlight">\(Y\)</span>) based on different marketing efforts. They have 100 weeks of data (<span class="math notranslate nohighlight">\(n=100\)</span>). They are considering two linear regression models:</p>
<ul class="simple">
<li><p><strong>Model 1 (Simple):</strong> <code class="docutils literal notranslate"><span class="pre">Sales</span> <span class="pre">~</span> <span class="pre">Online_Ads</span></code></p>
<ul>
<li><p>Parameters (<span class="math notranslate nohighlight">\(k\_1\)</span>): 2 (intercept + Online_Ads)</p></li>
<li><p>Sum of Squared Errors (<span class="math notranslate nohighlight">\(\\text{SSE}\_1\)</span>): 5000</p></li>
</ul>
</li>
<li><p><strong>Model 2 (Complex):</strong> <code class="docutils literal notranslate"><span class="pre">Sales</span> <span class="pre">~</span> <span class="pre">Online_Ads</span> <span class="pre">+</span> <span class="pre">TV_Ads</span> <span class="pre">+</span> <span class="pre">Radio_Ads</span></code></p>
<ul>
<li><p>Parameters (<span class="math notranslate nohighlight">\(k\_2\)</span>): 4 (intercept + Online_Ads + TV_Ads + Radio_Ads)</p></li>
<li><p>Sum of Squared Errors (<span class="math notranslate nohighlight">\(\\text{SSE}\_2\)</span>): 4800 (naturally lower because it has more predictors)</p></li>
</ul>
</li>
</ul>
<p>Which model is better according to AIC and BIC?</p>
<p><strong>Manual Calculation for AIC and BIC:</strong></p>
<p><strong>For Model 1:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n = 100\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_1 = 2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\\text{SSE}\_1 = 5000\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{AIC}_1 = n \cdot \ln\left(\frac{\text{SSE}_1}{n}\right) + 2k_1\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_1 = 100 \cdot \ln\left(\frac{5000}{100}\right) + 2 \cdot 2\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_1 = 100 \cdot \ln(50) + 4\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_1 \approx 100 \cdot 3.912 + 4 = 391.2 + 4 = \mathbf{395.2}\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_1 = n \cdot \ln\left(\frac{\text{SSE}_1}{n}\right) + k_1 \cdot \ln(n)\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_1 = 100 \cdot \ln(50) + 2 \cdot \ln(100)\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_1 \approx 391.2 + 2 \cdot 4.605 = 391.2 + 9.21 = \mathbf{400.41}\]</div>
<p><strong>For Model 2:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n = 100\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_2 = 4\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\\text{SSE}\_2 = 4800\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{AIC}_2 = n \cdot \ln\left(\frac{\text{SSE}_2}{n}\right) + 2k_2\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_2 = 100 \cdot \ln\left(\frac{4800}{100}\right) + 2 \cdot 4\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_2 = 100 \cdot \ln(48) + 8\]</div>
<div class="math notranslate nohighlight">
\[\text{AIC}_2 \approx 100 \cdot 3.871 + 8 = 387.1 + 8 = \mathbf{395.1}\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_2 = n \cdot \ln\left(\frac{\text{SSE}_2}{n}\right) + k_2 \cdot \ln(n)\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_2 = 100 \cdot \ln(48) + 4 \cdot \ln(100)\]</div>
<div class="math notranslate nohighlight">
\[\text{BIC}_2 \approx 387.1 + 4 \cdot 4.605 = 387.1 + 18.42 = \mathbf{405.52}\]</div>
<p><strong>Comparison:</strong></p>
<ul class="simple">
<li><p><strong>AIC:</strong> <span class="math notranslate nohighlight">\(\\text{AIC}\_1 = 395.2\)</span>, <span class="math notranslate nohighlight">\(\\text{AIC}\_2 = 395.1\)</span>. Model 2 has a slightly lower AIC, suggesting it’s marginally better according to AIC.</p></li>
<li><p><strong>BIC:</strong> <span class="math notranslate nohighlight">\(\\text{BIC}\_1 = 400.41\)</span>, <span class="math notranslate nohighlight">\(\\text{BIC}\_2 = 405.52\)</span>. Model 1 has a significantly lower BIC, suggesting it’s preferred.</p></li>
</ul>
<p><strong>Conclusion:</strong> AIC slightly favors the more complex Model 2, while BIC strongly favors the simpler Model 1 due to its harsher penalty for parameters, especially with 100 observations. This often happens: AIC tends to pick more complex models than BIC. The choice between AIC and BIC depends on whether the goal is prediction (AIC is often better) or finding the “true” model (BIC is more consistent).</p>
<p><strong>Python Code for AIC/BIC &amp; Plot:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span> <span class="c1"># For convenient AIC/BIC access in real models</span>

<span class="c1"># Set style for plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DejaVu Sans&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- AIC and BIC Comparison Example ---&quot;</span><span class="p">)</span>

<span class="c1"># Data for problem statement</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Number of observations</span>

<span class="c1"># Model 1: Sales ~ Online_Ads</span>
<span class="n">k1</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># Intercept + 1 predictor</span>
<span class="n">SSE1</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="c1"># Model 2: Sales ~ Online_Ads + TV_Ads + Radio_Ads</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># Intercept + 3 predictors</span>
<span class="n">SSE2</span> <span class="o">=</span> <span class="mi">4800</span>

<span class="c1"># Calculate AIC</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_aic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">sse</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sse</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k</span>

<span class="n">aic1</span> <span class="o">=</span> <span class="n">calculate_aic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">SSE1</span><span class="p">)</span>
<span class="n">aic2</span> <span class="o">=</span> <span class="n">calculate_aic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">SSE2</span><span class="p">)</span>

<span class="c1"># Calculate BIC</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_bic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">sse</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sse</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">bic1</span> <span class="o">=</span> <span class="n">calculate_bic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">SSE1</span><span class="p">)</span>
<span class="n">bic2</span> <span class="o">=</span> <span class="n">calculate_bic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">SSE2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model 1 (k=</span><span class="si">{</span><span class="n">k1</span><span class="si">}</span><span class="s2">, SSE=</span><span class="si">{</span><span class="n">SSE1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  AIC: </span><span class="si">{</span><span class="n">aic1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  BIC: </span><span class="si">{</span><span class="n">bic1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model 2 (k=</span><span class="si">{</span><span class="n">k2</span><span class="si">}</span><span class="s2">, SSE=</span><span class="si">{</span><span class="n">SSE2</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  AIC: </span><span class="si">{</span><span class="n">aic2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  BIC: </span><span class="si">{</span><span class="n">bic2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Plotting AIC and BIC values ---</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Model 1 (Simpler)&#39;</span><span class="p">,</span> <span class="s1">&#39;Model 2 (Complex)&#39;</span><span class="p">]</span>
<span class="n">aic_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">aic1</span><span class="p">,</span> <span class="n">aic2</span><span class="p">]</span>
<span class="n">bic_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">bic1</span><span class="p">,</span> <span class="n">bic2</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">rects1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">aic_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">rects2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bic_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Criterion Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AIC vs. BIC for Two Regression Models&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">,</span> <span class="n">ax_obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
        <span class="n">ax_obj</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">height</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># 3 points vertical offset</span>
                    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">autolabel</span><span class="p">(</span><span class="n">rects1</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">autolabel</span><span class="p">(</span><span class="n">rects2</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Example using statsmodels (for real regression analysis)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- AIC/BIC from a real regression model (conceptual) ---&quot;</span><span class="p">)</span>
<span class="c1"># Generate dummy data for illustration</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># 3 predictors</span>
<span class="n">y_dummy</span> <span class="o">=</span> <span class="n">X_dummy</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">X_dummy</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">X_dummy</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>

<span class="c1"># Add a constant for the intercept term for statsmodels</span>
<span class="n">X_dummy_sm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_dummy</span><span class="p">)</span>

<span class="c1"># Fit a full model (with 3 predictors)</span>
<span class="n">model_full</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_dummy</span><span class="p">,</span> <span class="n">X_dummy_sm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full Model (3 predictors):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  AIC: </span><span class="si">{</span><span class="n">model_full</span><span class="o">.</span><span class="n">aic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  BIC: </span><span class="si">{</span><span class="n">model_full</span><span class="o">.</span><span class="n">bic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fit a simpler model (e.g., just first predictor)</span>
<span class="n">X_simple_sm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_dummy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">model_simple</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_dummy</span><span class="p">,</span> <span class="n">X_simple_sm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simple Model (1 predictor):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  AIC: </span><span class="si">{</span><span class="n">model_simple</span><span class="o">.</span><span class="n">aic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  BIC: </span><span class="si">{</span><span class="n">model_simple</span><span class="o">.</span><span class="n">bic</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- AIC and BIC Comparison Example ---
Model 1 (k=2, SSE=5000):
  AIC: 395.20
  BIC: 400.41

Model 2 (k=4, SSE=4800):
  AIC: 395.12
  BIC: 405.54
</pre></div>
</div>
<img alt="../../_images/b7be772a48f4ce90053f9cd418e8131183e69715af1df12032551d8213d1e2c8.png" src="../../_images/b7be772a48f4ce90053f9cd418e8131183e69715af1df12032551d8213d1e2c8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- AIC/BIC from a real regression model (conceptual) ---
Full Model (3 predictors):
  AIC: 138.65
  BIC: 149.07

Simple Model (1 predictor):
  AIC: 194.00
  BIC: 199.21
</pre></div>
</div>
</div>
</div>
<p><strong>Interpretation of AIC/BIC Plot:</strong>
The bar chart visually compares the AIC and BIC values for the two models. It immediately highlights that for AIC, Model 2 is slightly lower (preferred), while for BIC, Model 1 is significantly lower (preferred). This clearly illustrates how BIC penalizes complexity more aggressively due to its <span class="math notranslate nohighlight">\(\\ln(n)\)</span> term, leading it to favor simpler models, especially with a reasonable number of observations (<span class="math notranslate nohighlight">\(n=100\)</span> in this case).</p>
</section>
<hr class="docutils" />
<section id="adjusted-r2">
<h4>7.3. Adjusted R²<a class="headerlink" href="#adjusted-r2" title="Link to this heading">#</a></h4>
<p><strong>Explanation:</strong>
<span class="math notranslate nohighlight">\(R^2\)</span> (R-squared) is a statistical measure that represents the proportion of the variance in the dependent variable that is predictable from the independent variables. It ranges from 0 to 1, where a higher value indicates a better fit.</p>
<p>However, a major limitation of standard <span class="math notranslate nohighlight">\(R^2\)</span> is that it <em>always</em> increases or stays the same when you add more independent variables to a regression model, even if those variables are not truly related to the dependent variable. This can lead to overfitting and mislead you into thinking a more complex model is better.</p>
<p><strong>Adjusted R²</strong> addresses this issue by penalizing the inclusion of unnecessary independent variables. It adjusts the <span class="math notranslate nohighlight">\(R^2\)</span> based on the number of predictors in the model and the number of observations. It will only increase if the new term improves the model more than would be expected by chance. If a new predictor does not improve the model significantly, the Adjusted R² will decrease.</p>
<p><strong>Formula:</strong>
$<span class="math notranslate nohighlight">\(\text{Adjusted } R^2 = 1 - \left[ \frac{(1 - R^2)(n - 1)}{n - k - 1} \right]\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R^2\)</span> is the ordinary R-squared value.</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of observations (data points).</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of independent variables (predictors) in the model (excluding the intercept).</p></li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul class="simple">
<li><p>When comparing models with different numbers of predictors, choose the model with the higher Adjusted R².</p></li>
<li><p>A higher Adjusted R² indicates that the model explains a higher proportion of variance with a meaningful number of predictors, avoiding the inflation issue of standard <span class="math notranslate nohighlight">\(R^2\)</span>.</p></li>
<li><p>Adjusted R² can be negative, especially for models with a very poor fit or too many predictors relative to the sample size.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="example-problem-statement-deciding-on-adding-predictors-to-a-sales-model">
<h4>Example Problem Statement: Deciding on Adding Predictors to a Sales Model<a class="headerlink" href="#example-problem-statement-deciding-on-adding-predictors-to-a-sales-model" title="Link to this heading">#</a></h4>
<p>A company is predicting sales (<span class="math notranslate nohighlight">\(Y\)</span>) based on advertising spend. They initially use <code class="docutils literal notranslate"><span class="pre">Online_Ads</span></code> as a predictor. They have 50 data points (<span class="math notranslate nohighlight">\(n=50\)</span>).</p>
<ul class="simple">
<li><p><strong>Model A (Simple):</strong> <code class="docutils literal notranslate"><span class="pre">Sales</span> <span class="pre">~</span> <span class="pre">Online_Ads</span></code></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(R^2 = 0.70\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_A = 1\)</span> (Online_Ads)</p></li>
</ul>
</li>
</ul>
<p>Now, they are considering adding <code class="docutils literal notranslate"><span class="pre">Website_Traffic</span></code> as a second predictor.</p>
<ul class="simple">
<li><p><strong>Model B (Complex):</strong> <code class="docutils literal notranslate"><span class="pre">Sales</span> <span class="pre">~</span> <span class="pre">Online_Ads</span> <span class="pre">+</span> <span class="pre">Website_Traffic</span></code></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(R^2 = 0.72\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_B = 2\)</span> (Online_Ads, Website_Traffic)</p></li>
</ul>
</li>
</ul>
<p>Should they include <code class="docutils literal notranslate"><span class="pre">Website_Traffic</span></code> in the model? Evaluate using Adjusted R².</p>
<p><strong>Manual Calculation for Adjusted R²:</strong></p>
<p><strong>For Model A:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R^2\_A = 0.70\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(n = 50\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_A = 1\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_A = 1 - \left[ \frac{(1 - 0.70)(50 - 1)}{50 - 1 - 1} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_A = 1 - \left[ \frac{(0.30)(49)}{48} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_A = 1 - \left[ \frac{14.7}{48} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_A = 1 - 0.30625 = \mathbf{0.69375}\]</div>
<p><strong>For Model B:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R^2\_B = 0.72\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(n = 50\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k\_B = 2\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_B = 1 - \left[ \frac{(1 - 0.72)(50 - 1)}{50 - 2 - 1} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_B = 1 - \left[ \frac{(0.28)(49)}{47} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_B = 1 - \left[ \frac{13.72}{47} \right]\]</div>
<div class="math notranslate nohighlight">
\[\text{Adjusted } R^2_B = 1 - 0.2919 = \mathbf{0.7081}\]</div>
<p><strong>Comparison:</strong></p>
<ul class="simple">
<li><p>Adjusted <span class="math notranslate nohighlight">\(R^2\_A = 0.69375\)</span></p></li>
<li><p>Adjusted <span class="math notranslate nohighlight">\(R^2\_B = 0.7081\)</span></p></li>
</ul>
<p>Since Adjusted <span class="math notranslate nohighlight">\(R^2\_B\)</span> (0.7081) is higher than Adjusted <span class="math notranslate nohighlight">\(R^2\_A\)</span> (0.69375), it suggests that adding <code class="docutils literal notranslate"><span class="pre">Website_Traffic</span></code> as a predictor is beneficial, as it improved the model’s explanatory power more than accounted for by the increased complexity.</p>
<p><strong>Python Code for Adjusted R² &amp; Plot:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>

<span class="c1"># Set style for plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DejaVu Sans&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Adjusted R-squared Example ---&quot;</span><span class="p">)</span>

<span class="c1"># Function to calculate Adjusted R-squared</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_adjusted_r2</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Problem statement data</span>
<span class="n">n_obs</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Model A (Simple)</span>
<span class="n">r2_A</span> <span class="o">=</span> <span class="mf">0.70</span>
<span class="n">k_A</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Number of predictors</span>

<span class="n">adj_r2_A</span> <span class="o">=</span> <span class="n">calculate_adjusted_r2</span><span class="p">(</span><span class="n">r2_A</span><span class="p">,</span> <span class="n">n_obs</span><span class="p">,</span> <span class="n">k_A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model A (k=</span><span class="si">{</span><span class="n">k_A</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  R-squared: </span><span class="si">{</span><span class="n">r2_A</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Adjusted R-squared: </span><span class="si">{</span><span class="n">adj_r2_A</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Model B (Complex)</span>
<span class="n">r2_B</span> <span class="o">=</span> <span class="mf">0.72</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># Number of predictors</span>

<span class="n">adj_r2_B</span> <span class="o">=</span> <span class="n">calculate_adjusted_r2</span><span class="p">(</span><span class="n">r2_B</span><span class="p">,</span> <span class="n">n_obs</span><span class="p">,</span> <span class="n">k_B</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model B (k=</span><span class="si">{</span><span class="n">k_B</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  R-squared: </span><span class="si">{</span><span class="n">r2_B</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Adjusted R-squared: </span><span class="si">{</span><span class="n">adj_r2_B</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Plotting R-squared vs. Adjusted R-squared ---</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Model A (k=1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Model B (k=2)&#39;</span><span class="p">]</span>
<span class="n">r2_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">r2_A</span><span class="p">,</span> <span class="n">r2_B</span><span class="p">]</span>
<span class="n">adj_r2_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">adj_r2_A</span><span class="p">,</span> <span class="n">adj_r2_B</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">rects1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">r2_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R-squared&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumseagreen&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">rects2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">adj_r2_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adjusted R-squared&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;R-squared vs. Adjusted R-squared Comparison&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="c1"># Set y-limit to better show differences</span>

<span class="k">def</span><span class="w"> </span><span class="nf">autolabel</span><span class="p">(</span><span class="n">rects</span><span class="p">,</span> <span class="n">ax_obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
        <span class="n">ax_obj</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">height</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># 3 points vertical offset</span>
                    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">autolabel</span><span class="p">(</span><span class="n">rects1</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">autolabel</span><span class="p">(</span><span class="n">rects2</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Conceptual illustration of Adjusted R2 behavior</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Conceptual Illustration: Adjusted R-squared behavior as predictors are added ---&quot;</span><span class="p">)</span>
<span class="n">num_observations_ill</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">true_r2</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">num_predictors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1"># 1 to 10 predictors</span>
<span class="n">simulated_r2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">simulated_adj_r2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Simulate R2 increasing slightly with each predictor</span>
<span class="c1"># And calculate Adjusted R2 based on these simulated R2 and n, k</span>
<span class="k">for</span> <span class="n">k_val</span> <span class="ow">in</span> <span class="n">num_predictors</span><span class="p">:</span>
    <span class="c1"># A simple way to simulate R2 increase, might not be perfectly linear in reality</span>
    <span class="c1"># But shows the concept</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">true_r2</span> <span class="o">+</span> <span class="p">(</span><span class="n">k_val</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># R2 increases by 0.01 for each predictor</span>
    <span class="k">if</span> <span class="n">r2_val</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span> <span class="n">r2_val</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="c1"># Cap at 0.99</span>
    
    <span class="n">adj_r2_val</span> <span class="o">=</span> <span class="n">calculate_adjusted_r2</span><span class="p">(</span><span class="n">r2_val</span><span class="p">,</span> <span class="n">num_observations_ill</span><span class="p">,</span> <span class="n">k_val</span><span class="p">)</span>
    
    <span class="n">simulated_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)</span>
    <span class="n">simulated_adj_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_r2_val</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_predictors</span><span class="p">,</span> <span class="n">simulated_r2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R-squared&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_predictors</span><span class="p">,</span> <span class="n">simulated_adj_r2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Adjusted R-squared&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R-squared vs. Adjusted R-squared as Predictors are Added&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Predictors (k)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R-squared Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">num_predictors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Adjusted R-squared Example ---
Model A (k=1):
  R-squared: 0.7000
  Adjusted R-squared: 0.6937

Model B (k=2):
  R-squared: 0.7200
  Adjusted R-squared: 0.7081
</pre></div>
</div>
<img alt="../../_images/7a70fcb30e7621c08f2b0a66e610f6734747dfc6f99807dbe2c9b597664523d4.png" src="../../_images/7a70fcb30e7621c08f2b0a66e610f6734747dfc6f99807dbe2c9b597664523d4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Conceptual Illustration: Adjusted R-squared behavior as predictors are added ---
</pre></div>
</div>
<img alt="../../_images/857937b2d202c0df49309f3d379ae7320565797c36b8655c8f03aabc572fa9fe.png" src="../../_images/857937b2d202c0df49309f3d379ae7320565797c36b8655c8f03aabc572fa9fe.png" />
</div>
</div>
<p><strong>Interpretation of Adjusted R² Plots:</strong></p>
<ul class="simple">
<li><p><strong>Bar Plot:</strong> This plot directly compares the R-squared and Adjusted R-squared for Model A and Model B. It visually demonstrates that while <span class="math notranslate nohighlight">\(R^2\)</span> always increases when adding a predictor, Adjusted <span class="math notranslate nohighlight">\(R^2\)</span> gives a more honest assessment, showing whether the increase in <span class="math notranslate nohighlight">\(R^2\)</span> is truly worthwhile after accounting for model complexity.</p></li>
<li><p><strong>Line Plot (Conceptual):</strong> This plot conceptually illustrates the key difference: <span class="math notranslate nohighlight">\(R^2\)</span> generally always increases or stays flat as more predictors are added, while Adjusted <span class="math notranslate nohighlight">\(R^2\)</span> can actually decrease if the new predictors do not significantly improve the model fit, thereby effectively penalizing unnecessary complexity. This makes Adjusted <span class="math notranslate nohighlight">\(R^2\)</span> a better metric for comparing models of different complexities.</p></li>
</ul>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Mathematics for Data Science\Statistics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">📍 7. Statistical Modeling and Resampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-methods">Resampling Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">7.1. Bootstrapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-estimating-confidence-interval-for-median-income">Example Problem Statement: Estimating Confidence Interval for Median Income</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation">7.2. Cross-validation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-evaluating-a-simple-linear-regression-model">Example Problem Statement: Evaluating a Simple Linear Regression Model</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aic-akaike-information-criterion">7.1. AIC (Akaike Information Criterion)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bic-bayesian-information-criterion">7.2. BIC (Bayesian Information Criterion)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-comparing-regression-models-for-sales-prediction">Example Problem Statement: Comparing Regression Models for Sales Prediction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusted-r2">7.3. Adjusted R²</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problem-statement-deciding-on-adding-predictors-to-a-sales-model">Example Problem Statement: Deciding on Adding Predictors to a Sales Model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>